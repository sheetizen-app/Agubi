<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGUBI - Asisten Guru Bahasa Indonesia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body class="text-gray-800">

    <div id="app-container" class="container mx-auto p-4 md:p-6 max-w-4xl">
        
        <!-- Landing View -->
        <div id="landing-view" class="hidden fade-in">
            <div class="bg-white p-8 rounded-xl shadow-lg max-w-md mx-auto text-center">
                <div class="inline-block bg-green-600 text-white p-4 rounded-full mb-4">
                    <i class="fa-solid fa-school fa-2x"></i>
                </div>
                <h1 class="text-3xl font-bold text-gray-800">Selamat Datang di AGUBI</h1>
                <p class="text-gray-500 mt-2 mb-8">Platform Literasi untuk Guru dan Siswa Hebat.</p>
                <div class="space-y-4">
                    <button id="go-to-school-code-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300 text-lg">
                        <i class="fa-solid fa-right-to-bracket mr-2"></i> Masuk / Login
                    </button>
                    <button id="go-to-register-btn" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition duration-300 text-lg">
                        <i class="fa-solid fa-user-plus mr-2"></i> Daftar Akun Guru Baru
                    </button>
                </div>
            </div>
        </div>

        <!-- REVISED: School Code Verification View (for Students AND Teachers) -->
        <div id="school-code-view" class="hidden fade-in">
            <div class="bg-white p-8 rounded-xl shadow-lg max-w-md mx-auto">
                <div id="school-code-form-section">
                    <h1 class="text-2xl font-bold text-center text-gray-700 mb-2">Verifikasi Sekolah</h1>
                    <p class="text-center text-gray-500 mb-6">Masukkan Kode Sekolah untuk melanjutkan.</p>
                    <form id="school-code-form">
                        <div class="mb-4">
                            <label for="kode-sekolah" class="block text-sm font-medium text-gray-600 mb-1">Kode Sekolah</label>
                            <input type="text" id="kode-sekolah" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" required placeholder="Contoh: SMPN1BDG">
                        </div>
                        <button type="submit" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300">Lanjutkan</button>
                        <p id="school-code-error" class="text-red-500 text-sm mt-4 text-center"></p>
                    </form>
                </div>
                <div id="school-code-options-section" class="hidden text-center">
                     <h1 class="text-2xl font-bold text-center text-gray-700 mb-2">Sekolah Terverifikasi!</h1>
                     <p class="text-center text-gray-500 mb-6">Selamat datang di <span id="verified-school-name" class="font-bold text-blue-600"></span>. Silakan pilih peran Anda.</p>
                     <div class="space-y-4">
                        <button id="go-to-teacher-login-btn" class="w-full bg-blue-800 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-900 transition duration-300 text-lg">
                            <i class="fa-solid fa-chalkboard-user mr-2"></i> Login sebagai Guru
                        </button>
                        <button id="go-to-student-verification-btn" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition duration-300 text-lg">
                            <i class="fa-solid fa-user-graduate mr-2"></i> Masuk sebagai Siswa
                        </button>
                     </div>
                </div>
                <button id="back-to-landing-1" class="w-full mt-4 text-sm text-blue-600 hover:underline">Kembali ke Halaman Awal</button>
            </div>
        </div>

        <!-- Step 1 Registration View -->
        <div id="register-view" class="hidden fade-in">
            <div class="bg-white p-8 rounded-xl shadow-lg max-w-md mx-auto">
                 <h1 class="text-2xl font-bold text-center text-gray-700 mb-2">Daftar Akun Guru</h1>
                 <p class="text-center text-gray-500 mb-6">Langkah 1: Buat akun Anda. Setelah itu, verifikasi email Anda.</p>
                <form id="register-form">
                    <div class="space-y-4">
                        <div>
                            <label for="register-email" class="block text-sm font-medium text-gray-600 mb-1">Email</label>
                            <input type="email" id="register-email" class="w-full px-4 py-2 border border-gray-300 rounded-lg" required placeholder="guru.hebat@email.com">
                        </div>
                        <div>
                            <label for="register-password" class="block text-sm font-medium text-gray-600 mb-1">Password</label>
                            <input type="password" id="register-password" class="w-full px-4 py-2 border border-gray-300 rounded-lg" required placeholder="Minimal 6 karakter">
                        </div>
                    </div>
                    <button type="submit" class="w-full mt-6 bg-green-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-green-700 transition duration-300">Daftar & Kirim Verifikasi</button>
                    <p id="register-message" class="text-sm mt-4 text-center"></p>
                </form>
                <button id="back-to-landing-2" class="w-full mt-4 text-sm text-blue-600 hover:underline">Kembali ke Halaman Awal</button>
            </div>
        </div>
        
        <!-- Check Email View -->
        <div id="check-email-view" class="hidden fade-in">
             <div class="bg-white p-8 rounded-xl shadow-lg max-w-md mx-auto text-center">
                <div class="inline-block bg-blue-600 text-white p-4 rounded-full mb-4">
                    <i class="fa-solid fa-envelope-circle-check fa-2x"></i>
                </div>
                <h1 class="text-3xl font-bold text-gray-800">Verifikasi Email Anda</h1>
                <p class="text-gray-500 mt-2 mb-8">Kami telah mengirimkan link verifikasi ke email Anda. Silakan klik link tersebut untuk melanjutkan. Setelah itu, kembali ke halaman ini dan login.</p>
                <button id="go-to-login-from-email" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300 text-lg">
                    <i class="fa-solid fa-right-to-bracket mr-2"></i> Kembali ke Halaman Login
                </button>
            </div>
        </div>
        
        <!-- Step 2 Create School View -->
        <div id="create-school-view" class="hidden fade-in">
            <div class="bg-white p-8 rounded-xl shadow-lg max-w-md mx-auto">
                 <h1 class="text-2xl font-bold text-center text-gray-700 mb-2">Selamat Datang, Guru!</h1>
                 <p class="text-center text-gray-500 mb-6">Langkah Terakhir: Daftarkan sekolah Anda untuk memulai.</p>
                <form id="create-school-form">
                    <div class="space-y-4">
                        <div>
                            <label for="create-nama-sekolah" class="block text-sm font-medium text-gray-600 mb-1">Nama Sekolah</label>
                            <input type="text" id="create-nama-sekolah" class="w-full px-4 py-2 border border-gray-300 rounded-lg" required placeholder="Contoh: SMP Negeri 1 Bandung">
                        </div>
                        <div>
                            <label for="create-kode-sekolah" class="block text-sm font-medium text-gray-600 mb-1">Kode Sekolah <span class="text-xs">(unik, tanpa spasi)</span></label>
                            <input type="text" id="create-kode-sekolah" class="w-full px-4 py-2 border border-gray-300 rounded-lg" required placeholder="Contoh: SMPN1BDG">
                        </div>
                    </div>
                    <button type="submit" class="w-full mt-6 bg-green-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-green-700 transition duration-300">Simpan Data Sekolah & Masuk Dasbor</button>
                    <p id="create-school-message" class="text-sm mt-4 text-center"></p>
                </form>
            </div>
        </div>

        <!-- REVISED: Teacher Login View (shown after school code verification) -->
        <div id="login-view" class="hidden fade-in">
            <div class="bg-white p-8 rounded-xl shadow-lg max-w-md mx-auto">
                <h1 class="text-2xl font-bold text-center text-gray-700 mb-2">Login Guru</h1>
                <p id="login-school-context" class="text-center text-gray-500 mb-6">Untuk sekolah: <span id="login-school-name" class="font-bold text-blue-600"></span></p>
                <form id="login-form">
                    <div class="mb-4">
                        <label for="email" class="block text-sm font-medium text-gray-600 mb-1">Email</label>
                        <input type="email" id="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div class="mb-6">
                        <label for="password" class="block text-sm font-medium text-gray-600 mb-1">Password</label>
                        <input type="password" id="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300">Login</button>
                    <p id="login-error" class="text-red-500 text-sm mt-4 text-center"></p>
                </form>
                <button class="back-to-school-code-btn w-full mt-4 text-sm text-blue-600 hover:underline">Ganti Sekolah</button>
                <button id="switch-to-student-from-login" class="w-full mt-2 text-sm text-blue-600 hover:underline">Login sebagai Siswa</button>
            </div>
        </div>

        <!-- Student View -->
        <div id="student-view" class="hidden">
            <header class="text-center mb-8 fade-in">
                <div class="inline-block bg-green-600 text-white p-3 rounded-full mb-4">
                    <i class="fa-solid fa-book-open fa-2x"></i>
                </div>
                <h1 class="text-3xl font-bold text-gray-800">AGUBI - Portal Siswa</h1>
                <p class="text-gray-500 mt-1">Sekolah: <span id="student-school-name" class="font-bold text-green-700"></span></p>
            </header>

            <div id="student-form-container" class="bg-white p-6 md:p-8 rounded-xl shadow-md max-w-lg mx-auto fade-in">
                <div id="verification-section">
                    <h2 class="text-xl font-semibold mb-1 flex items-center"><i class="fa-solid fa-user-check mr-2 text-blue-500"></i> Verifikasi Data Diri</h2>
                    <p class="text-sm text-gray-500 mb-6">Masukkan data untuk memulai.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="kelas" class="block text-sm font-medium text-gray-600 mb-1">Kelas</label>
                            <select id="kelas" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 bg-gray-50" required></select>
                        </div>
                        <div>
                            <label for="nama-siswa" class="block text-sm font-medium text-gray-600 mb-1">Nama Siswa</label>
                            <select id="nama-siswa" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 bg-gray-50" required disabled></select>
                        </div>
                        <div>
                            <label for="nis" class="block text-sm font-medium text-gray-600 mb-1">NIS (sebagai password)</label>
                            <input type="password" id="nis" placeholder="Masukkan NIS kamu" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <button id="check-data-button" class="w-full mt-6 bg-blue-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-blue-700 transition duration-300">Cek Data</button>
                    <p id="verification-message" class="mt-3 text-sm text-center"></p>
                </div>
                
                <div id="progress-form-section" class="hidden">
                    <h2 class="text-xl font-semibold mb-1 flex items-center"><i class="fa-solid fa-book-medical mr-2 text-green-500"></i> Input Progres Baca</h2>
                    <p class="text-sm text-gray-500 mb-6">Hai <span id="student-name-display" class="font-bold"></span>! Lanjutkan kebiasaan baikmu.</p>
                    <form id="student-form" class="space-y-4">
                        <div class="relative">
                            <label for="judul-buku" class="block text-sm font-medium text-gray-600 mb-1">Judul Buku</label>
                            <input type="text" id="judul-buku" placeholder="Contoh: Laskar Pelangi" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" required autocomplete="off">
                            <div id="book-suggestions" class="hidden shadow-lg"></div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="halaman-awal" class="block text-sm font-medium text-gray-600 mb-1">Halaman Awal</label>
                                <input type="number" id="halaman-awal" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" required>
                            </div>
                            <div>
                                <label for="halaman-akhir" class="block text-sm font-medium text-gray-600 mb-1">Halaman Akhir</label>
                                <input type="number" id="halaman-akhir" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" required>
                            </div>
                        </div>
                        <div>
                            <label for="deskripsi" class="block text-sm font-medium text-gray-600 mb-1">Deskripsi Singkat Bacaan</label>
                            <textarea id="deskripsi" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" required></textarea>
                        </div>

                        <div class="pt-2">
                            <div class="flex items-center">
                                <input id="is-selesai-checkbox" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="is-selesai-checkbox" class="ml-2 block text-sm text-gray-900">Tandai buku ini sudah selesai dibaca</label>
                            </div>
                        </div>
                        <div id="review-section" class="hidden space-y-4 pt-4 border-t border-gray-200">
                            <h3 class="text-md font-semibold text-center text-gray-700">Berikan Ulasanmu!</h3>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-2 text-center">Rating Bintang</label>
                                <div class="star-rating-container">
                                    <input type="radio" id="star5" name="rating" value="5" class="star-rating-input"><label for="star5" class="star-rating-label"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="star4" name="rating" value="4" class="star-rating-input"><label for="star4" class="star-rating-label"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="star3" name="rating" value="3" class="star-rating-input"><label for="star3" class="star-rating-label"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="star2" name="rating" value="2" class="star-rating-input"><label for="star2" class="star-rating-label"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="star1" name="rating" value="1" class="star-rating-input"><label for="star1" class="star-rating-label"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                            <div>
                                <label for="ulasan-teks" class="block text-sm font-medium text-gray-600 mb-1">Ulasan Singkat (Opsional)</label>
                                <textarea id="ulasan-teks" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"></textarea>
                            </div>
                        </div>

                        <button type="submit" id="submit-button" class="w-full bg-green-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-green-700 transition duration-300">Simpan Progres</button>
                        <p id="student-message" class="mt-3 text-sm text-center"></p>
                    </form>
                </div>
            </div>

            <div id="student-dashboard-section" class="hidden max-w-lg mx-auto mt-8 space-y-6">
                <div class="flex justify-between items-center bg-white p-4 rounded-xl shadow-md">
                    <div>
                        <p class="text-sm text-gray-500">Selamat Datang,</p>
                        <p id="dashboard-student-name" class="font-bold text-lg"></p>
                    </div>
                    <button id="logout-student-button" class="text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg transition duration-300">
                        <i class="fa-solid fa-right-from-bracket mr-2"></i>Ganti Siswa
                    </button>
                </div>

                <div id="new-achievement-toast" class="hidden p-4 rounded-lg bg-yellow-400 text-black font-bold text-center"></div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="student-stat-card">
                        <div><p class="text-sm text-gray-500">Total Halaman</p><p id="student-stat-total-halaman" class="text-3xl font-bold">0</p></div><i class="fa-solid fa-book-open"></i>
                    </div>
                    <div class="student-stat-card">
                        <div><p class="text-sm text-gray-500">Buku Dibaca</p><p id="student-stat-buku-dibaca" class="text-3xl font-bold">0</p></div><i class="fa-solid fa-star" style="color: #f59e0b;"></i>
                    </div>
                </div>
                 <div class="student-stat-card">
                    <div><p class="text-sm text-gray-500">Kecepatan Rata-rata</p><p id="student-stat-kecepatan" class="text-3xl font-bold">0</p><p class="text-xs text-gray-500">halaman/hari</p></div><i class="fa-solid fa-chart-line"></i>
                </div>

                <div id="student-achievement-section" class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-semibold mb-4">Achievement Kamu</h3>
                    <div id="student-achievement-list" class="grid grid-cols-2 sm:grid-cols-3 gap-4"></div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-semibold mb-4">Grafik Progres Mingguan</h3>
                    <canvas id="student-chart"></canvas>
                </div>
                
                <div id="my-reviews-section" class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-semibold mb-4">Ulasan Buku Kamu</h3>
                    <div id="my-reviews-list" class="space-y-4"></div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-semibold mb-4">Histori Membaca</h3>
                    <div id="history-table-container" class="space-y-3"></div>
                </div>
                
                <button id="report-again-button" class="w-full bg-blue-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-blue-700 transition duration-300">
                    <i class="fa-solid fa-plus mr-2"></i> Lapor Progres Lagi
                </button>
            </div>

            <div class="text-center mt-8 space-y-4">
                <button id="show-recommendations-btn" class="text-sm text-blue-600 hover:underline">Lihat Ulasan & Rekomendasi Buku</button>
                <button id="switch-to-teacher-from-student" class="block w-full text-sm text-blue-600 hover:underline">Login sebagai Guru</button>
                <button class="back-to-school-code-btn block w-full text-sm text-gray-500 hover:text-blue-600 hover:underline">Ganti Sekolah</button>
            </div>
        </div>

        <div id="recommendation-view" class="hidden">
            <header class="text-center mb-8">
                <div class="inline-block bg-yellow-500 text-white p-3 rounded-full mb-4">
                    <i class="fa-solid fa-star fa-2x"></i>
                </div>
                <h1 class="text-3xl font-bold text-gray-800">Ulasan & Rekomendasi Buku</h1>
                <p class="text-gray-500 mt-1">Lihat buku apa saja yang sedang populer di sekolah <span id="recom-school-name" class="font-bold text-yellow-600"></span>!</p>
            </header>
            <div class="flex flex-col md:flex-row gap-4 mb-6 bg-gray-100 p-4 rounded-lg">
                <input type="text" id="public-review-search" placeholder="Cari judul buku..." class="w-full md:w-2/3 px-4 py-2 border border-gray-300 rounded-lg">
                <select id="public-review-rating-filter" class="w-full md:w-1/3 px-4 py-2 border border-gray-300 rounded-lg">
                    <option value="semua">Semua Rating</option>
                    <option value="5">★★★★★</option>
                    <option value="4">★★★★☆ & up</option>
                    <option value="3">★★★☆☆ & up</option>
                    <option value="2">★★☆☆☆ & up</option>
                    <option value="1">★☆☆☆☆ & up</option>
                </select>
            </div>
            <div id="public-review-list-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            </div>
            <div class="text-center mt-8">
                <button id="back-to-main-btn" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">Kembali ke Halaman Utama</button>
            </div>
        </div>

        <div id="teacher-view" class="hidden">
             <div class="flex justify-between items-center mb-6">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">Dasbor Performa Literasi</h1>
                    <p class="text-gray-500 mt-1">Sekolah: <span id="teacher-school-name" class="font-bold text-green-700"></span></p>
                </div>
                <button id="logout-button" class="bg-red-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-600">Logout</button>
            </div>
            <div id="teacher-loader" class="flex justify-center items-center py-8 hidden"><div class="loader"></div></div>
            <div id="teacher-dashboard-content" class="space-y-8 hidden">
                <div class="bg-white p-4 rounded-xl shadow-lg flex flex-wrap gap-4 items-center">
                    <div>
                        <label for="teacher-filter-kelas" class="font-medium mr-2">Filter Kelas:</label>
                        <select id="teacher-filter-kelas" class="px-4 py-2 border border-gray-300 rounded-lg"></select>
                    </div>
                    <div>
                        <label for="teacher-filter-month" class="font-medium mr-2">Top Performer Bulan:</label>
                        <select id="teacher-filter-month" class="px-4 py-2 border border-gray-300 rounded-lg"></select>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="teacher-stat-card">
                        <div><p class="text-sm text-gray-500">Total Siswa</p><p id="stat-total-siswa" class="text-3xl font-bold">0</p></div><i class="fa-solid fa-users"></i>
                    </div>
                    <div class="teacher-stat-card">
                        <div><p class="text-sm text-gray-500">Total Halaman</p><p id="stat-total-halaman" class="text-3xl font-bold">0</p></div><i class="fa-solid fa-book-open"></i>
                    </div>
                    <div class="teacher-stat-card">
                        <div><p class="text-sm text-gray-500">Rata-rata Halaman</p><p id="stat-rata-halaman" class="text-3xl font-bold">0</p></div><i class="fa-solid fa-chart-bar"></i>
                    </div>
                    <div class="teacher-stat-card">
                        <div><p class="text-sm text-gray-500">Kecepatan Rata-rata</p><p id="stat-kecepatan" class="text-3xl font-bold">0</p><p class="text-xs text-gray-500">halaman/hari</p></div><i class="fa-solid fa-chart-line"></i>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg">
                        <h2 class="text-xl font-bold mb-4 flex items-center"><i class="fa-solid fa-trophy mr-2 text-yellow-500"></i> Top Performers</h2>
                        <ol id="top-performers-list" class="list-decimal list-inside space-y-3"></ol>
                    </div>
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                        <h2 class="text-xl font-bold mb-4 flex items-center"><i class="fa-solid fa-chart-pie mr-2 text-blue-500"></i> Insight Kelas</h2>
                        <div id="class-insights-container" class="space-y-4"></div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-bold mb-4">Manajemen Data</h2>
                    <div class="flex border-b border-gray-200">
                        <button id="student-list-tab-btn" class="tab-btn py-2 px-4 -mb-px text-gray-500 hover:text-blue-600 active">Daftar Siswa</button>
                        <button id="add-student-tab-btn" class="tab-btn py-2 px-4 text-gray-500 hover:text-blue-600">Tambah Siswa</button>
                        <button id="import-student-tab-btn" class="tab-btn py-2 px-4 text-gray-500 hover:text-blue-600">Impor Siswa</button>
                        <button id="reviews-tab-btn" class="tab-btn py-2 px-4 text-gray-500 hover:text-blue-600">Ulasan Buku</button>
                    </div>

                    <div id="student-list-tab" class="mt-4">
                        <input type="text" id="student-list-search" placeholder="Cari nama siswa..." class="w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-lg mb-4">
                        <div class="overflow-x-auto border rounded-lg">
                            <table class="w-full text-sm text-left text-gray-500">
                                <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-4 py-3">NIS</th>
                                        <th scope="col" class="px-4 py-3">Nama</th>
                                        <th scope="col" class="px-4 py-3">Kelas</th>
                                        <th scope="col" class="px-4 py-3 text-center">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="student-list-table-body"></tbody>
                            </table>
                        </div>
                    </div>

                    <div id="add-student-tab" class="hidden mt-4">
                        <form id="add-student-form" class="max-w-md space-y-4">
                            <div>
                                <label for="add-nis" class="block text-sm font-medium text-gray-600 mb-1">NIS (Nomor Induk Siswa)</label>
                                <input type="text" id="add-nis" class="w-full px-3 py-2 border border-gray-300 rounded-lg" required>
                            </div>
                             <div>
                                <label for="add-nama" class="block text-sm font-medium text-gray-600 mb-1">Nama Lengkap</label>
                                <input type="text" id="add-nama" class="w-full px-3 py-2 border border-gray-300 rounded-lg" required>
                            </div>
                             <div>
                                <label for="add-kelas" class="block text-sm font-medium text-gray-600 mb-1">Kelas</label>
                                <input type="text" id="add-kelas" class="w-full px-3 py-2 border border-gray-300 rounded-lg" required>
                            </div>
                            <button type="submit" class="w-full bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700">Simpan Siswa</button>
                            <p id="add-student-message" class="text-sm text-center"></p>
                        </form>
                    </div>

                    <div id="import-student-tab" class="hidden mt-4">
                        <p class="text-sm text-gray-600 mb-4">
                            Untuk menambahkan siswa secara massal, unduh template CSV, isi data siswa, lalu impor kembali ke sistem.
                            Pastikan kolom <code class="bg-gray-200 p-1 rounded-sm">nis</code> unik untuk setiap siswa.
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
                            <div>
                                <button id="download-template-btn" class="w-full bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition duration-300">
                                    <i class="fa-solid fa-download mr-2"></i> Unduh Template CSV
                                </button>
                            </div>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">
                                 <label for="import-csv-input" class="w-full cursor-pointer bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300">
                                    <i class="fa-solid fa-upload mr-2"></i> Pilih File CSV
                                 </label>
                                 <input type="file" id="import-csv-input" class="hidden" accept=".csv">
                                 <p id="import-status" class="text-sm mt-2 text-gray-500">Belum ada file dipilih.</p>
                            </div>
                        </div>
                        <div id="import-preview-container" class="hidden mt-6">
                            <h3 class="text-lg font-semibold mb-2">Pratinjau Data Impor</h3>
                            <p class="text-sm text-gray-600 mb-4">Silakan periksa data di bawah ini. Jika sudah benar, klik "Konfirmasi & Impor".</p>
                            <p id="import-school-id" class="text-sm text-gray-700 mb-2"></p>
                            <div id="import-preview-table" class="overflow-x-auto border rounded-lg max-h-60"></div>
                            <div class="mt-4 flex flex-col sm:flex-row gap-4">
                                <button id="confirm-import-btn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">
                                    <i class="fa-solid fa-check-circle mr-2"></i> Konfirmasi & Impor
                                </button>
                                <button id="cancel-import-btn" class="w-full bg-gray-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-600">
                                    <i class="fa-solid fa-times-circle mr-2"></i> Batal
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="reviews-tab" class="hidden mt-4">
                        <h3 class="text-xl font-semibold mb-4">Ulasan Buku dari Siswa</h3>
                        <div class="flex flex-wrap gap-4 items-center mb-4 bg-gray-50 p-3 rounded-lg">
                             <div class="flex-grow">
                                <label for="review-filter-kelas" class="text-sm font-medium mr-2">Kelas:</label>
                                <select id="review-filter-kelas" class="px-3 py-1.5 border border-gray-300 rounded-lg text-sm">
                                    <option value="semua">Semua Kelas</option>
                                </select>
                            </div>
                             <div class="flex-grow">
                                <label for="review-filter-rating" class="text-sm font-medium mr-2">Rating:</label>
                                <select id="review-filter-rating" class="px-3 py-1.5 border border-gray-300 rounded-lg text-sm">
                                    <option value="semua">Semua Rating</option>
                                    <option value="5">★★★★★</option>
                                    <option value="4">★★★★☆</option>
                                    <option value="3">★★★☆☆</option>
                                    <option value="2">★★☆☆☆</option>
                                    <option value="1">★☆☆☆☆</option>
                                </select>
                            </div>
                        </div>
                        <div id="review-list-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-bold mb-4">Manajemen Achievement</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold mb-2" id="form-ach-title">Buat Achievement Baru</h3>
                            <div class="flex border border-gray-200 rounded-lg p-1 bg-gray-100 mb-4">
                                <button id="manual-ach-tab" class="w-1/2 py-2 rounded-md bg-white shadow text-blue-600 font-semibold">Manual</button>
                                <button id="auto-ach-tab" class="w-1/2 py-2 rounded-md text-gray-500">Otomatis</button>
                            </div>
                            <form id="create-achievement-form" class="space-y-3"></form>
                            <h3 class="text-lg font-semibold mt-6 mb-2">Daftar Achievement</h3>
                            <ul id="achievement-list" class="space-y-2"></ul>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold mb-2">Berikan Achievement Manual</h3>
                            <form id="award-achievement-form" class="space-y-3">
                                <select id="award-class-select" class="w-full px-3 py-2 border rounded-lg"><option value="semua">Semua Kelas</option></select>
                                <input type="text" id="award-student-search" placeholder="Ketik nama siswa..." class="w-full px-3 py-2 border rounded-lg">
                                <select id="award-student-select" class="w-full px-3 py-2 border rounded-lg" required><option>Pilih Siswa</option></select>
                                <select id="award-achievement-select" class="w-full px-3 py-2 border rounded-lg" required><option>Pilih Achievement</option></select>
                                <button type="submit" class="w-full bg-blue-600 text-white font-bold py-2 rounded-lg">Berikan</button>
                                <p id="award-message" class="text-sm text-center"></p>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
                     <div class="flex flex-wrap gap-4 items-center mb-4">
                        <h2 class="text-xl font-bold">Data Progres Siswa</h2>
                        <div class="flex-grow flex flex-wrap gap-4 items-center justify-end">
                            <select id="progress-table-filter-kelas" class="px-3 py-1.5 border border-gray-300 rounded-lg text-sm"><option value="semua">Semua Kelas</option></select>
                            <input type="date" id="progress-table-filter-start-date" class="px-3 py-1.5 border border-gray-300 rounded-lg text-sm">
                            <input type="date" id="progress-table-filter-end-date" class="px-3 py-1.5 border border-gray-300 rounded-lg text-sm">
                            <button id="progress-table-apply-filter" class="bg-blue-500 text-white px-4 py-1.5 rounded-lg text-sm">Terapkan</button>
                            <button id="progress-table-reset-filter" class="bg-gray-200 px-4 py-1.5 rounded-lg text-sm">Reset</button>
                        </div>
                     </div>
                     <table class="w-full text-sm text-left text-gray-500">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3">Tanggal</th><th scope="col" class="px-6 py-3">Siswa</th><th scope="col" class="px-6 py-3">Buku</th><th scope="col" class="px-6 py-3">Progres Halaman</th><th scope="col" class="px-6 py-3">Deskripsi</th>
                            </tr>
                        </thead>
                        <tbody id="teacher-table-body"></tbody>
                    </table>
                </div>
            </div>
            <button id="switch-to-student-from-teacher" class="w-full mt-6 text-sm text-blue-600 hover:underline">Kembali ke Halaman Murid</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
